# Claude Code 项目开发规则

## 🎯 核心原则
- **重用优于重写** - 优先检查和重用现有API端点、函数和逻辑
- **简单优于复杂** - 选择最简单可行的解决方案
- **一致性优于创新** - 保持与现有代码风格和格式一致

## 🔍 编辑前检查清单
在进行任何代码修改前：
- [ ] 检查是否有现有功能可以重用
- [ ] 确认修改不会超出平台限制
- [ ] 查看相关文件的现有模式和风格

## ✅ 编辑后验证清单
每次代码修改后自动检查：
- [ ] **语法检查** - 所有变量是否已定义
- [ ] **依赖检查** - 引用的文件和函数是否存在
- [ ] **逻辑验证** - 函数调用参数是否正确
- [ ] **格式统一** - 代码风格与项目保持一致
- [ ] **错误处理** - 添加适当的错误处理和日志

## 🚫 平台限制 (Vercel Hobby)
- **API函数限制**: 最多12个 (当前: 9个)
- **Cron任务限制**: 最多2个 (当前: 2个)
- **优先策略**: 合并功能到现有端点，避免创建新文件

## 📁 项目结构规则
- **API路由**: `/api/` - 主要功能端点
- **子模块**: `/api/user/`, `/api/cron/`, `/api/records/` - 分类功能
- **配置文件**: `vercel.json`, `package.json` - 谨慎修改
- **文档**: 保持README和相关文档更新

## 🔧 特定技术规则

### Telegram Bot
- 重用现有消息模板 (`lib/i18n.js`)
- 统一错误处理和日志格式
- 保持与现有回调处理逻辑一致

### 数据库 (Supabase)
- 使用现有数据模型和字段名
- 重用现有查询模式
- 保持事务处理一致性

### 前端集成
- 保持与现有按钮和界面风格一致
- 重用现有回调数据格式

## 🎯 工作流程
1. **分析需求** - 理解要解决的问题
2. **检查现有** - 查找可重用的解决方案
3. **选择方案** - 优先选择最简单的实现
4. **实现代码** - 遵循现有模式和风格
5. **自动验证** - 运行完整检查清单
6. **测试确认** - 验证功能正常工作

## 📝 提交规则
- 使用清晰的提交信息描述更改
- 包含修复的问题和添加的功能
- 添加 Claude Code 生成标记

## ⚠️ 特别注意
- **分类代码**: 统一使用中文，避免英文代码
- **API调用**: 重用现有端点，避免创建重复功能
- **错误处理**: 提供详细的错误信息和调试日志
- **格式一致性**: 保持消息格式与现有功能一致

---
*此文件定义了项目的开发规范，确保代码质量和一致性*